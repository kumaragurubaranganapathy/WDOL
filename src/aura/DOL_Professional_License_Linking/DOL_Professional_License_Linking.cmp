<!--
* name 		    : DOL_Professional_License_Linking
* @description 	: To link license to  logged in users contact
* @author 		: Mangesh
* @date 		: 07/11/2019
* MODIFICATION LOG:
* DEVELOPER                     DATE                               DESCRIPTION
_________________________________________________________________________________
* Mangesh	      07/11/2019	      A Brief Desc about the Change
-->

<aura:component implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes" access="global" controller="DOL_License_Linking" >
    
    
    <aura:attribute name="hasSecurityCode" type="Boolean" default="false" />
     <aura:attribute name="emailID" type="String" />
    <aura:attribute name="mailID" type="String"  />
     <aura:attribute name="emailToSend" type="String"  />
     <aura:attribute name="mailToSend" type="String"  />
    <aura:attribute name="LicenseID" type="String"  />
    <aura:attribute name="ActivationCode" type="String"  />
    <aura:attribute name="ReviewName" type="String"  />
    <aura:attribute name="doesNotHaveSecurityCode" type="Boolean" default="false" />
    <aura:attribute name="licenseTypeList" type="List" description="Holds the lists of licenseType"/>
    <aura:attribute name="programTypeList" type="List" description="Holds the lists of programType"/>
    <aura:attribute name="licenseColumnList" type="List" description="Holds the lists of licenseType"/>
    <aura:attribute name="LicenseColumnListData" type="List" description="Holds the lists of accounts"/>
    <aura:attribute name="linkingScreen" type="Boolean" default="true" description="checks if linking screen or not"/>
    <aura:attribute name="options" type="List" description="contains options for radio group" default="[
                                                                                                       {'label': 'Email', 'value': 'Email'},
                                                                                                       {'label': 'Mail', 'value': 'Mail'}
                                                                                                       
                                                                                                       ]"/>
    <aura:attribute name="value" type="String" default=""/>
    <aura:attribute name="media" type="String" default="Email"/>
    <aura:attribute name="loadingSpinner" type="Boolean" default="false" />
    <aura:attribute name="disabled" type="Boolean" default="true" />
    <aura:attribute name="showEmail" type="Boolean" default="false" />
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
	<aura:handler name="render" value="{!this}" action="{!c.onRender}"/>
    
    <aura:if isTrue="{!v.loadingSpinner}">
        <lightning:spinner aura:id="spinner" class="spinner-style" alternativeText="Page is loading..."/>
    </aura:if>
        <div class="prof-link-wrapper">
        <aura:if isTrue="{!v.linkingScreen}">
            
            <div class="page-header prof-link-title">
                Link Existing Professional License
            </div>
              
            <div class="new-wrapper">
                <div class="link-help">
                    <p class="link-help">If you don't have an activation code, use the search below to link your professional license.</p>                
                   
                </div>
                
                
                
                <div class="token-wrapper details-search">
                    <lightning:input aura:id="securityToken" label="First Name" class="field-size"
                                     name="FirstName"
                                     value=""
                                     required="true"/>
                    <lightning:input aura:id="securityToken" label="Last Name" class="field-size"
                                     name="lastName"
                                     value=""
                                     required="true"/>
                    
                    <lightning:input type ="Date" aura:id="securityToken" label="Date of Birth" class="field-size"
                                     name="DOB"
                                     value=""
                                     required="true"/>
                    <lightning:input aura:id="securityToken" label="Last 4 digits of your SSN" class="field-size"
                                     name="ssn"
                                     value=""
                                     required="true"
                                     maxlength ="4"/>
                    <lightning:select aura:id="securityToken" name="licenseType" label="License Type" variant="Brand"  class="field-size">
                        <option value="" text="None"/>    
                        <aura:iteration items="{!v.licenseTypeList}" var="licenseType">
                            <option value="{!licenseType}">{!licenseType}</option>
                        </aura:iteration>
                    </lightning:select>
                    <lightning:input aura:id="securityToken" label="License" class="field-size"
                                     name="license"
                                     value=""
                                     />
                    
                    
                </div>
                
                <div class ="button-wrapper">
                    <button class="slds-button slds-button_neutral cancel-button" onclick ="{!c.cancelBusiness}">Cancel</button>
                    <button class="slds-button slds-button_brand proceed-btn slds-m-left_small" onclick ="{!c.searchLicense2}">Search</button>
                    
                </div>                
            </div>             
            <div class="new-wrapper">
                <div class="heading link-title">
                    Link using an activation code
                </div>
                <p class="link-help">If you have an activation code, enter it below or you can <a href="javascript:void(0)" onclick="{!c.redirectRequest}">request an activation code</a> using your license number.</p>
              
                
                
                
                
                <div class="token-wrapper">
                    <lightning:input aura:id="securityTokenId" label="Activation Code"
                                     name="securityToken"
                                     value=""
                                     required="true"
                                     class="activation-code field-size"/> 
                    
                </div>
                
                <div class ="button-wrapper">
                    <button class="slds-button slds-button_neutral cancel-button" onclick ="{!c.cancelBusiness}">Cancel</button>
                    <button class="slds-button slds-button_brand proceed-btn slds-m-left_small" onclick ="{!c.searchLicense}">Verify Code</button>
                    
                </div>                
            </div>
        
            <div id="scrollTillHere"></div>
            <aura:if isTrue="{!not(empty(v.LicenseColumnListData))}">
                <div class="new-wrapper" aura:id="account-id">
                    <div class="ser-title">
                        Confirm and link professional license
                    </div>
                    <p class="link-help">
                        If this is your professional license, link it to your Polaris account
                    </p>
                    
                    <aura:iteration items="{!v.LicenseColumnListData}" var="biz" indexVar="ind">
                        <lightning:layout class="token-wrapper">                
                            <lightning:layoutItem size="12" mediumDeviceSize="3" class="biz-details">  
                                 <span class="field-style">License:</span>
                                {!biz.Name}
                            </lightning:layoutItem>
                            <lightning:layoutItem size="12" mediumDeviceSize="5" class="biz-details"> 
                                    <span class="field-style">License Type:</span>
                                <span class="data-style">{!biz.Credential_Type__c}</span>
                                
                            </lightning:layoutItem>
                            <lightning:layoutItem size="12" mediumDeviceSize="4" class="biz-details">                        
                                <span class="field-style">License Status:</span>
                                <span class="data-style">{!biz.MUSW__Status__c}</span>
                            </lightning:layoutItem>
                            
                        </lightning:layout>             
                    </aura:iteration>
                    <div id="buttonDataBusiness2" class ="button-wrapper">
                        <button class="slds-button slds-button_neutral" onclick ="{!c.cancelBusiness}">Cancel</button>
                        <button class="slds-button slds-button_brand slds-m-left_small" onclick ="{!c.linkLicenseToContact}">Link License</button>
                        
                    </div>  
                </div>
            </aura:if>
            
        <aura:set attribute="else">
               
                <div class="heading pad link-title">
                    Request Activation Code
                </div>
               <div class="slds-m-bottom_small">Enter license details to request an activation code</div>
               <div class="token-wrapper licensecon">
                   <lightning:input aura:id="licenseNumber" label="License" class="field-size"
                                     name="License"
                                     value=""
                                     required = "true"/>
                     <lightning:select aura:id="programToken" name="programType" label="Program Type" variant="Brand" class="field-size" required = "true">
                        <option value="" text="None"/>    
                        <aura:iteration items="{!v.programTypeList}" var="programType">
                            <option value="{!programType}">{!programType}</option>
                        </aura:iteration>
                    </lightning:select>
               </div>
                <div class="btnAlign">
                        <lightning:button variant="neutral" label="Cancel" class='btn-lnp cancel-button' title="Cancel" type="text" onclick="{!c.goBack}"/>
                        <lightning:button variant="Brand" label="Next" aura:id="btnNext" class="proceed-btn" onclick= "{!c.searchLicenseActivation}"/>
                   </div>
                <div class="{!v.showEmail?'new-wrapper':'slds-hide'}">
                   
                        <div class="token-wrapper">
                       <!-- <lightning:radioGroup name="radioGroup"                          
                                              options="{! v.options }"
                                              value="{!v.value }"
                                              type="radio"
                                              class="radio-style" onchange= "{!c.sendEmail}" />{!v.emailID}-->
                        <div class="flexdisp">
                      
                        <div class="emaillabel"> {!v.emailID}</div>
                        </div>
                    
                   
                        
                    </div>
                    <div class="call-option">If your email is incorrect or you want to get an activation code by phone, please contact {!$Label.c.Phone_number_Activation_code}</div>
                   <div class="btnAlign">
                        <lightning:button variant="neutral" label="Cancel" class='btn-lnp cancel-button' title="Cancel" type="text" onclick="{!c.goBack}"/>
                        <lightning:button variant="Brand" label="Submit" title="Submit" aura:id="btnProceed"  onclick = "{!c.sendEmailFinal}"  disabled ="{!v.disabled}" class="proceed-btn"/>
                   </div>

                </div>
            </aura:set>    
        </aura:if>
    </div>
</aura:component>