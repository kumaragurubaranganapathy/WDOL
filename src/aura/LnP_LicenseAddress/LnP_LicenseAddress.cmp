<aura:component controller="LnP_LicenseAddressApexController" implements="forceCommunity:availableForAllPageTypes" access="global">
    <aura:attribute name="parcel" type="LnP_Parcel__c" default ="{
                                                                 'sobjectType' : 'LnP_Parcel__c',
                                                                 'Address_Type__c' : '',
                                                                 'Street__c' : '',
                                                                 'City__c' : '',
                                                                 'State_Province__c' : '',
                                                                 'County__c' : '',
                                                                 'Country__c' : '',
                                                                 'Zip_Postal_Code__c' : '', 
                                                                 'Application_BG__c':''
                                                                 }"/>
    <aura:attribute name="addressDType" Type="LnP_Parcel__c" />
    <aura:attribute name="LicenseAddressList" type="List"/>
    <aura:attribute name="state" type="String"/>
    <aura:attribute name="city" type="String"/>
    <aura:attribute name="county" type="List"/>
    <aura:attribute name="selAddress" type="String"/>
    <aura:attribute name="lstAddress" type="SOD_Autocomplete_Wrapper" />
    <aura:attribute name="showResults" type="Boolean" default="false" />
    <aura:attribute name="mydata" type="List"/>
    <aura:attribute name="isHide" type="Boolean" default="false" />
    <aura:attribute name="selectedValue" type="String"/>
    <aura:attribute name="applicationId" type="Id"/>
    <aura:attribute name="checkBox" type="Boolean" default="false"/>
    <aura:attribute name="sObjParcel" type="String" default="LnP_Parcel__c"/>
    <aura:attribute name="addressTypeOptions" type="List" default="[ {'label': '--None--', 'value': '--None--'},
                                                                   {'label': 'US Address', 'value': 'US Address'},
                                                                   {'label': 'Existing Address', 'value': 'Existing Address'},
                                                                   ]"/>
    <aura:attribute name="typeOfAddress" type="String" />
    <aura:attribute name="existingAddr" type="String" />
    <aura:attribute name="isAddrVerification" type="String"/>
    
    
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    <div class="addressDetail">
        <aura:if isTrue="{!not(empty(v.LicenseAddressList))}">               
            <div class="slds-grid slds-wrap">
                <aura:iteration items="{!v.LicenseAddressList}" var="address" indexVar="itemRow">
                    <div class="slds-col slds-size_4-of-12 address">
                        <div class="tile">
                            <div class="typeofaddress" title="Type of Address"><span class="address-title">{!address.Address_Type__c}</span></div>
                            <div class="record" title="Address">
                                {!address.Street__c},<br/>
                                {!address.City__c}, {!address.State_Province__c}, <br/>
                                {!address.County__c},<br/>
                                {!address.Zip_Postal_Code__c},<br/>
                                {!address.Country__c}
                             <ui:outputText value="{!address.Id}" class="slds-hide addressId" aura:id="addressId"/>
                            </div>
                            <div class="slds-grid action-buttons slds-m-bottom_small ">
                                <div id= "{!address.Id}" class="{!address.Application_BG__c}" style="margin-left: 91%; margin-top: 1%;">
                                    <lightning:buttonIcon name="{!address.Address_Type__c}" iconName="utility:delete" class="slds-col_bump-left" iconClass="slds-button__icon_hint" variant="bare" alternativeText="Delete Record" onclick="{!c.handleDelete}"/> 
                                </div>
                            </div>
                        </div>
                    </div>
                </aura:iteration>
            </div>
            
        </aura:if>
    </div>
    
    <lightning:button class="slds-m-top_x-large address-button" variant="brand" label="+ Address" onclick="{!c.addAddress}"/>
    <div class="slds-p-top_x-large address-wrapper">
       <div class="addressTypeSelection slds-hide slds-size_12-of-12">
            <lightning:select class="field-size" name="select1" label="Type of address" required="false" value="{!v.typeOfAddress}" onchange="{!c.onSelect}">
                <aura:iteration items="{!v.addressTypeOptions}" var="addrType">
                    <option value="{!addrType.value}" >{!addrType.label}</option>
                </aura:iteration>
            </lightning:select>
        </div> 
    
    <div class="addAddress slds-hide  slds-size_12-of-12">
           
        <aura:if isTrue="{!v.typeOfAddress == 'Existing Address'}"> 
            <div class="existingAddress" >
                <lightning:select class="field-size" name="existingAdd" label="Choose one" required="true" value="{!v.existingAddr}" onchange="{!c.selectExistingAddress}">
                    
                    <aura:iteration items="{!v.LicenseAddressList}" var="address" >
                        <option value="{!address.Street__c+','+address.City__c+','+address.State_Province__c+','+address.County__c+','+address.Country__c+','+address.Zip_Postal_Code__c}" >{!address.Street__c}, {!address.City__c}, {!address.State_Province__c},{!address.County__c},{!address.Country__c},{!address.Zip_Postal_Code__c}</option>
                    </aura:iteration>                    
                </lightning:select>
            </div>
        </aura:if>
       <aura:if isTrue="{!v.typeOfAddress == 'US Address'}"> 
            <div id="usAddr" class = "usAddress">
                <lightning:select name="addressType" aura:id="addressType" label="Address Type" required="true" value="{!v.parcel.Address_Type__c}" class="field-size field-margin address-fields">
                    <aura:iteration items="{!v.addressDType}" var="addType">
                        <option value="{!addType.value}" >{!addType.label}</option>
                    </aura:iteration>
                </lightning:select> 

                
                <lightning:input title="street" name="street" label="Street" value="{!v.parcel.Street__c}"  required="true" class="field-size address-fields"/>
                <!--<ul class="{!v.showResults ? 'addList' : 'slds-hide'}">
                    <aura:iteration items="{!v.lstAddress.suggestions}" var="gAddress">                                
                        <li onclick="{!c.selectAddress}" data-index="{!gAddress.city+'_'+gAddress.state}" 
                            data-text="{!gAddress.text}">{!gAddress.text}</li>
                    </aura:iteration>                
                </ul>-->
                <lightning:input  name="Unit" label="Apartment No/Building No" value="{!v.parcel.Unit__c}"  required="false" class="field-size address-fields"/>
                <lightning:input name="city" label="City" value="{!v.parcel.City__c}" required="true" class="field-size field-margin address-fields" onblur="{!c.onCityChange}"/>
                <lightning:input name="state" label="State/Territory/Province" value="{!v.parcel.State_Province__c}" required="true" class="field-size address-fields" onblur="{!c.onStateChange}"/>
                <lightning:select aura:id="county" name="county" label="County" value="{!v.selectedValue}" required="false" class="field-size field-margin address-fields" onchange="{!c.onCountySelect}"> 
                	<aura:iteration items="{!v.county}" var="eachCounty">
                        <option text="{!eachCounty.label}" value="{!eachCounty.value}" selected="{!eachCounty.selected}"/>
                    </aura:iteration>
           		</lightning:select>
                <lightning:input name="country" label="Country" value="{!v.parcel.Country__c}" required="true" class="field-size address-fields"/>
                <lightning:input name="zip" label="Zip/Postal Code" value="{!v.parcel.Zip_Postal_Code__c}" required="true" class="field-size field-margin address-fields"/>
            </div>
        </aura:if>
        <div class="slds-grid slds-p-top_x-large">
            <lightning:button variant="brand" type="submit" name="save" label="Validate" onclick="{!c.saveAddress}" class="slds-m-right_x-large next-button"/>
            <lightning:button variant="brand" type="cancel" name="cancel" label="Cancel" onclick="{!c.cancelAddress}" class="slds-m-left_medium next-button"/>
    	</div>
        </div>
    </div>
    <aura:if isTrue="{!v.isAddrVerification == 'YES'}"> 
        <c:Dol_AddressVerificationCmp applicationId="{!v.applicationId}"/>
    </aura:if>
   

    </aura:component>