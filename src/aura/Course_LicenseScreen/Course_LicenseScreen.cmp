<aura:component implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickAction" access="global" controller = "Add_BusinessController" >
    <aura:attribute name="MandatoryActionsApplicationsColumns" type="List" default="['REQUEST TYPE','REQUEST AGAINST ','DUE DATE']"/>
    <aura:attribute name="CourseApplicationsColumns" type="List" default="['Course#','Course Name','Course Type','Delivery Method','Expiration Date','Clock Hours','Status']" />
    <aura:attribute name="courseList" type="List" />
    <aura:attribute name="accountId" type="String" />
    <aura:attribute name="loadingSpinner" type="Boolean" default="true" />    
    <aura:attribute name="dispList" type="List" />
    <aura:registerEvent name="businessRefresh" type="c:RefreshEvent" />
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    <aura:if isTrue="{!v.loadingSpinner}">
        <lightning:spinner aura:id="spinner" alternativeText="Page is loading..."/>
    </aura:if>
    <div class="course-lic-wrapper">
        <aura:if isTrue="{!v.courseList.length!=0}">
            <div class="table-height">
                <div style="height: 100%; position: relative;">                    
                    <div class="table-scroll">                            
                        <table class="slds-table slds-table_cell-buffer slds-max-medium-table_stacked slds-table_bordered">
                            <thead>
                                <tr class="slds-line-height_reset">
                                    <aura:iteration items="{!v.CourseApplicationsColumns}" var="headerData">
                                        <th class="" scope="col">
                                            <div class="slds-truncate" title="{!headerData}">{!headerData}</div>
                                        </th>                                  
                                    </aura:iteration>
                                    <th class="" scope="col">
                                        <div class="slds-truncate" title="actions">Action</div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <aura:iteration items="{!v.dispList}" var="tableData" indexVar="ind"> 
                                    <tr class="slds-hint-parent">
                                        <td data-label="Course" class="cell-style">
                                            <u> <a data-index="{!ind}" data-accountId = "{!tableData.MUSW__Primary_Licensee__c}" data-licenseId="{!tableData.Id}" href="javascript:void(0)" onclick="{!c.displayCourseDetails}">
                                                {!tableData.Name}</a>
                                            </u>
                                        </td>
                                        <td data-label="Course Name" class="cell-style">
                                            <aura:if isTrue="{!tableData.Course_Title__c}">
                                                <div class="slds-truncate" title="{!tableData.Course_Title__c}">{!tableData.Course_Title__c}</div>
                                                <aura:set attribute="else">None</aura:set>
                                            </aura:if>
                                        </td>
                                        <td data-label="Course Type" class="cell-style">
                                            <aura:if isTrue="{!tableData.Course_Type__c}">
                                                <div class="slds-truncate" title="{!tableData.Course_Type__c}">{!tableData.Course_Type__c}</div>
                                                <aura:set attribute="else">None</aura:set>
                                            </aura:if>
                                        </td>
                                        <td data-label="Delivery Method" class="cell-style">
                                            <aura:if isTrue="{!tableData.Delivery_Method__c}">
                                                <div class="slds-truncate" title="{!tableData.Delivery_Method__c}">{!tableData.Delivery_Method__c}</div>
                                                <aura:set attribute="else">None</aura:set>
                                            </aura:if>     
                                        </td>
                                       
                                        <td data-label="Expiration Date" class="cell-style">
                                            <aura:if isTrue="{!tableData.MUSW__Expiration_Date__c}">
                                                <div class="slds-truncate" title="{!tableData.MUSW__Expiration_Date__c}"><lightning:formattedDateTime year="numeric" day="2-digit" month="long" value="{!tableData.MUSW__Expiration_Date__c}" /></div>
                                                <aura:set attribute="else">None</aura:set>
                                            </aura:if>
                                        </td>
                                        <td data-label="Clock Hours" class="cell-style">
                                            <aura:if isTrue="{!tableData.Clock_Hours__c}">
                                                <div class="slds-truncate" title="{!tableData.Clock_Hours__c}">{!tableData.Clock_Hours__c}</div>
                                                <aura:set attribute="else">None</aura:set>
                                            </aura:if>
                                        </td>
                                        <td data-label="Status" class="cell-style">
                                            <aura:if isTrue="{!tableData.MUSW__Status__c}">
                                                <div class="slds-truncate" title="{!tableData.MUSW__Status__c}">{!tableData.MUSW__Status__c}</div>
                                                <aura:set attribute="else">None</aura:set>
                                            </aura:if>                                                
                                        </td>
                                        <td data-label="Actions" class="cell-style action-cell">
                                            <div class="action-btn">
                                                <aura:if isTrue="{!and((tableData.Is_Renewal_Eligible__c || tableData.Is_Late_Renewal_Eligible__c|| tableData.Is_Reinstatement_Eligible__c),(tableData.MUSW__Status__c == 'Active')) ? true : false}">
                                                    <aura:if isTrue="{!and((tableData.Is_Renewal_Eligible__c || tableData.Is_Late_Renewal_Eligible__c),tableData.Renew_Reinstatement_in_progress__c == false)}">
                                                        <div onclick ="{!c.renewLicense}" data-appisRenewal="{!tableData.Application__r.isRenewal__c}" data-app="{!tableData.Application__c}" data-recordId = "{!tableData.Id}" data-licenseType = "{!tableData.Credential_Type__c}"
                                                             data-board = "{!tableData.Application_Type__c}" data-renewereinstate="Renewal"  data-applicationType = "{!tableData.Application_Method__c}" data-isrenewal="{!tableData.isRenewal__c}">
                                                            <lightning:button variant="brand" label="Renewal" title="Renewal" />
                                                        </div>
                                                    </aura:if>
                                                    <aura:if isTrue="{!and(tableData.Is_Reinstatement_Eligible__c,tableData.Renew_Reinstatement_in_progress__c == false)}">
                                                        <div onclick ="{!c.renewLicense}" data-appisRenewal="{!tableData.Application__r.isRenewal__c}" data-recordId = "{!tableData.Id}" data-licenseType = "{!tableData.Credential_Type__c}"
                                                             data-board = "{!tableData.Application_Type__c}" data-renewereinstate="Reinstatement" data-app="{!tableData.Application__c}" data-applicationType = "{!tableData.Application_Method__c}" data-isreinstate ="{!tableData.Is_Reinstatement_Eligible__c}">
                                                            <lightning:button variant="brand" label="Reinstate" title="Reinstate" />
                                                        </div>
                                                    </aura:if>
                                                </aura:if>
                                            </div> 
                                           <!-- <aura:if isTrue="{!tableData.MUSW__Status__c == 'In Review' || tableData.MUSW__Status__c == 'Active'}">
                                                <lightning:button variant="brand" label="Download Application" value="{!tableData.Id}" title="Download Application" onclick= "{!c.downloadDocument}"/>
                                            </aura:if> -->
                                        </td>
                                        
                                    </tr>
                                </aura:iteration>
                            </tbody>
                        </table>
                        
                    </div>                    
                </div>
            </div>
            <div class="pagination-wrapper">
                <c:LnP_Pagination fullList="{!v.courseList}" dispList="{!v.dispList}" pgSize="5" />
            </div>
            <aura:set attribute="else">
                <div class="empty-state">There are no course licenses</div>
            </aura:set>
            
        </aura:if>
    </div>
</aura:component>