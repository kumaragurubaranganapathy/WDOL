<!--@AUTHOR: Sanghmitra Sahu/Tuhin Mazumder
@Date: 01-Oct-2018 

Description: Lightning component created for Portal Public Forms. 

MODIFICATION LOG:
DEVELOPER                          DATE                     DESCRIPTION
================================================================================
Sanghmitra Sahu/Tuhin Mazumder     14-Sep-2018             Initial Creation
================================================================================= -->
<aura:component implements="forceCommunity:availableForAllPageTypes" controller="LnP_PublicFormsApexController" access="global" >
	<aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
 	<aura:attribute name="pageHeader" type="String"/>
    <aura:attribute name="errortext" type="String" default=""/>
    <aura:attribute name="sectionIcons" type="List"/>
    <aura:attribute name="currentTab" type="Integer" default="1"/>   
	<aura:attribute name="section" type="List"/>
	<aura:attribute name="witness" type="Boolean" default="false"/>
	<aura:attribute name="prefix" type="String" />
    <aura:attribute name="state" type="String"/>
    <aura:attribute name="city" type="String"/> 
    <aura:attribute name="lstAddress" type="SOD_Autocomplete_Wrapper" />
    <aura:attribute name="showResults" type="Boolean" default="false" />
    <aura:attribute name="spinner" type="Boolean" default="false"/>
    
    <c:LnP_ServerActionService aura:id="server"/>
     <aura:if isTrue="{!v.spinner}">
        <lightning:spinner aura:id="spinner" alternativeText="Page is loading..."/>
    </aura:if>
    <span class="slds-hide page-header">{!v.pageHeader}</span>
	<div  id="vv" class="slds-wrap">
      
		<aura:iteration items="{!v.section}" var="section" indexVar="varSection">
			<div class="slds-show section">
				<div class="login-margin static-content slds-m-top--small">
					<div class="header">{!section.header}</div>					
				</div>
                <div class="slds-p-top_large"><span class="content">{!section.staticText}</span></div>
				<div>
					<div class="slds-grid slds-wrap footer-bottom-margin">
						<div class="text-col slds-small-size_1-of-1 slds-medium-size_1-of-2">
                            <div class="">{!section.staticText1}</div>
                            <!--div class="license-btn">
                            	<lightning:button variant="brand" label="I have a license" title="I have a license" onclick="" class="btn"/>
                            	<lightning:button variant="brand" label="I don't have a license" title="I don't have a license" onclick="" class="btn"/>
                            </div-->  
                            <div class="slds-p-top_x-small">
                                <u><a href="{!$Label.c.Polaris_Portal_Registration}">{!section.staticText2}</a></u>
                            </div>
						</div>
                       
                      <div class="login-form-layout">                        
						<div class="slds-wrap login-form slds-small-size_1-of-1 slds-medium-size_1-of-2">
						<aura:iteration items="{!section.fields}" var="item" indexVar="count">
							<aura:if isTrue="{!item.type=='text-for-checkbox'}">
								<aura:set attribute="else">
									<div class="{!'slds-col field-item '+ section.class}">
										<aura:if isTrue="{!and(item.type!='textarea',item.type!='picklist',item.type!='text')}">
											<aura:if isTrue="{!item.title=='Street Address'}">
												<lightning:input aura:id="prefix" required="{!item.required}" name="{!item.title}" label="{!item.title}" placeholder="{!item.placeholder}" 
															 type="text" pattern="{!item.pattern}" value="{!v.prefix}" onchange="{!c.getAddress}"/>

												<ul class="{!v.showResults ? 'addList' : 'slds-hide'}">
													<aura:iteration items="{!v.lstAddress.suggestions}" var="gAddress">                                
													<li onclick="{!c.selectAddress}" data-index="{!gAddress.city+'_'+gAddress.state}" 
													data-text="{!gAddress.text}">{!gAddress.text}</li>
													</aura:iteration>                
												</ul>
												
												<aura:set attribute="else">	
													<aura:if isTrue="{!v.currentTab==2}">
														<lightning:input aura:id="formFields2" class="userpswd" required="{!item.required}" name="{!item.title}" label="{!item.title}" placeholder="{!item.placeholder}"
														type="{!item.type}" pattern="{!item.pattern}" value="{!item.title=='City'?v.city:(item.title=='State'?v.state:'')}"/>
														
													<aura:set attribute="else">	
                                                        <span onkeypress="{!c.search}">
                                                            
														<lightning:input aura:id="formFieldsRest" class="userpswd1" required="{!item.required}" name="{!item.title}" label="{!item.title}" placeholder="{!item.placeholder}"
														type="{!item.type}" pattern="{!item.pattern}" onkeyup="{!c.clearfields}" updateOn="keyup" value="{!item.title=='City'?v.city:(item.title=='State'?v.state:'')}"/>
													     </span>
                                                        </aura:set>
                                                       
													</aura:if>	
												</aura:set>
											</aura:if>
										</aura:if>
									</div>
                                    
								</aura:set>
							</aura:if>
						</aura:iteration>
						 <div class="errortext">{!v.errortext}</div>
						</div>
						 
                        <div class="slds-show login-btn-padding">
                        	<lightning:button variant="brand" label="Login" title="Login" onclick="{!c.loginReq}" class="login-btn"/>
    					</div>
						<div class="slds-show slds-p-top_x-small login-btn-padding">
							<aura:iteration items="{!v.section}" var="section">
                                <span><u><a href="{!$Label.c.Polaris_Portal_ForgotPassword}">{!section.staticText3}</a></u></span> |
                                <span><u><a href="{!$Label.c.Polaris_Portal_ForgotPassword}">{!section.staticText4}</a></u></span>
                            </aura:iteration>
						</div>
						</div>
					</div>
				</div>
			</div>
		</aura:iteration>
        
    </div>
</aura:component>